/* ============================================================
   üìò ShriVidya ‡§∂‡•Å‡§¶‡•ç‡§ß‚Äì‡§µ‡§æ‡§£‡•Ä Live Quiz System
   üïâÔ∏è ‡§∏‡§Ç‡§Ø‡•ã‡§ú‡§ï: ShriVidya ‚Äì ‡§∂‡•ç‡§∞‡•Ä‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ
   ------------------------------------------------------------
   üìÑ ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡§æ‡§Æ: main.js
   üéØ ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø:
      ‡§Ø‡§π ‡§´‡§º‡§æ‡§á‡§≤ "ShriVidya ‡§∂‡•Å‡§¶‡•ç‡§ß‚Äì‡§µ‡§æ‡§£‡•Ä Live Quiz System" ‡§ï‡•á
      ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§≤‡•â‡§ú‡§ø‡§ï ‡§á‡§Ç‡§ú‡§® ‡§ï‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à ‚Äî ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó,
      ‡§â‡§§‡•ç‡§§‡§∞ ‡§ö‡§Ø‡§®, ‡§∏‡•ç‡§ï‡•ã‡§∞‡§ø‡§Ç‡§ó, ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£, ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§Æ‡•â‡§°‡•ç‡§Ø‡•Ç‡§≤ ‡§ï‡•á
      ‡§≤‡§ø‡§è ‡§Ü‡§ß‡§æ‡§∞ ‡§ï‡•ã‡§° ‡§∏‡§Æ‡•ç‡§Æ‡§ø‡§≤‡§ø‡§§ ‡§π‡•à‡•§

      ‡§Ø‡§π Version 3.0 Hybrid Blueprint ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§π‡•à‡•§
   ------------------------------------------------------------
   ‚öôÔ∏è ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§æ‡§∞‡•ç‡§Ø:
      ‚Ä¢ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§î‡§∞ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ
      ‚Ä¢ ‡§∏‡§π‡•Ä/‡§ó‡§≤‡§§ ‡§â‡§§‡•ç‡§§‡§∞ ‡§™‡§π‡§ö‡§æ‡§®‡§®‡§æ
      ‚Ä¢ ‡§∏‡•ç‡§ï‡•ã‡§∞‡§ø‡§Ç‡§ó ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡§®‡§æ (+4 / -1 / +1)
      ‚Ä¢ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ Placeholder ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§®‡§æ
      ‚Ä¢ ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§Æ‡•á‡§Ç Voice Engine (voiceEngine.js) ‡§∏‡•á ‡§≤‡§ø‡§Ç‡§ï ‡§π‡•á‡§§‡•Å ‡§π‡•Å‡§ï ‡§ú‡•ã‡§°‡§º‡§®‡§æ
   ------------------------------------------------------------
   üìÖ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£ ‡§§‡§ø‡§•‡§ø: ‡§¶‡§ø‡§∏‡§Ç‡§¨‡§∞ 2025
   üßæ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£: 3.0 Hybrid
   ============================================================ */


/* ========== 1Ô∏è‚É£ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§°‡•á‡§ü‡§æ (Demo Placeholder) ========== */
// ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§Æ‡•á‡§Ç ‡§á‡§∏‡•á Google Sheets ‡§∏‡•á ‡§≤‡•ã‡§° ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ
const quizData = [
  {
    question: "‚Äò‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‚Äô ‡§∂‡§¨‡•ç‡§¶ ‡§ï‡§æ ‡§ß‡§æ‡§§‡•Å ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
    options: ["‡§µ‡•á‡§¶", "‡§µ‡§ø‡§¶‡•ç", "‡§µ‡§¶‡•ç", "‡§µ‡§®‡•ç‡§¶‡•ç"],
    correct: 1,
    explanation:
      "‚Äò‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‚Äô ‡§∂‡§¨‡•ç‡§¶ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§ ‡§ß‡§æ‡§§‡•Å ‚Äò‡§µ‡§ø‡§¶‡•ç‚Äô ‡§∏‡•á ‡§¨‡§®‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à ‚Äò‡§ú‡§æ‡§®‡§®‡§æ‚Äô‡•§ (‡§∏‡•ç‡§∞‡•ã‡§§: Wikipedia / Shabdkosh)"
  },
  {
    question: "‚Äò‡§ó‡•Å‡§∞‡•Å‚Äô ‡§∂‡§¨‡•ç‡§¶ ‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
    options: [
      "‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ï",
      "‡§ú‡•ã ‡§Ö‡§Ç‡§ß‡§ï‡§æ‡§∞ ‡§π‡§ü‡§æ‡§è",
      "‡§ú‡•ã ‡§µ‡•á‡§¶ ‡§™‡§¢‡§º‡§æ‡§è",
      "‡§ú‡•ã ‡§∂‡§ø‡§ï‡•ç‡§∑‡§£ ‡§ï‡§∞‡•á"
    ],
    correct: 1,
    explanation:
      "‚Äò‡§ó‡•Å‡§∞‡•Å‚Äô ‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à ‡§ú‡•ã ‡§Ö‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡§æ ‡§Ö‡§Ç‡§ß‡§ï‡§æ‡§∞ ‡§π‡§ü‡§æ‡§ï‡§∞ ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§´‡•à‡§≤‡§æ‡§è‡•§ (‡§∏‡•ç‡§∞‡•ã‡§§: ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ï‡•ã‡§∂)"
  },
  {
    question: "‚Äò‡•ê‚Äô ‡§ï‡§ø‡§∏‡§ï‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§π‡•à?",
    options: [
      "‡§§‡•ç‡§∞‡§ø‡§¶‡•á‡§µ",
      "‡§è‡§ï‡§§‡•ç‡§µ",
      "‡§™‡•ç‡§∞‡§ï‡•É‡§§‡§ø",
      "‡§∏‡•É‡§∑‡•ç‡§ü‡§ø"
    ],
    correct: 0,
    explanation:
      "‚Äò‡•ê‚Äô ‡§§‡•ç‡§∞‡§ø‡§¶‡•á‡§µ (‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ, ‡§µ‡§ø‡§∑‡•ç‡§£‡•Å, ‡§Æ‡§π‡•á‡§∂) ‡§ï‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§π ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ ‡§ï‡§æ ‡§Æ‡•Ç‡§≤ ‡§®‡§æ‡§¶ ‡§Æ‡§æ‡§®‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§"
  }
];


/* ========== 2Ô∏è‚É£ DOM ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü ‡§ö‡§Ø‡§® ========== */
const languageSelector = document.getElementById("language-selector");
const quizContainer = document.getElementById("quiz-container");
const resultContainer = document.getElementById("result-container");
const questionText = document.getElementById("question-text");
const optionsBox = document.getElementById("options-box");
const nextBtn = document.getElementById("next-btn");
const restartBtn = document.getElementById("restart-btn");
const finalScore = document.getElementById("final-score");
const explanationBox = document.getElementById("explanation-box");

/* ========== 3Ô∏è‚É£ ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï ‡§Æ‡§æ‡§® ========== */
let currentQuestion = 0;
let score = 0;
let selectedOption = null;

/* ========== 4Ô∏è‚É£ ‡§≠‡§æ‡§∑‡§æ ‡§ö‡§Ø‡§® ‡§≤‡•â‡§ú‡§ø‡§ï ========== */
document.querySelectorAll(".lang-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    languageSelector.classList.add("hidden");
    quizContainer.classList.remove("hidden");
    loadQuestion();
  });
});

/* ========== 5Ô∏è‚É£ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø ========== */
function loadQuestion() {
  const q = quizData[currentQuestion];
  questionText.textContent = q.question;
  optionsBox.innerHTML = "";

  q.options.forEach((option, index) => {
    const btn = document.createElement("button");
    btn.textContent = option;
    btn.classList.add("option-btn");
    btn.onclick = () => selectOption(index);
    optionsBox.appendChild(btn);
  });
}

/* ========== 6Ô∏è‚É£ ‡§â‡§§‡•ç‡§§‡§∞ ‡§ö‡§Ø‡§® ‡§≤‡•â‡§ú‡§ø‡§ï ========== */
function selectOption(index) {
  selectedOption = index;
  const allOptions = document.querySelectorAll(".option-btn");
  allOptions.forEach(btn => btn.disabled = true);

  if (index === quizData[currentQuestion].correct) {
    score += 4;
    allOptions[index].style.backgroundColor = "#4caf50";
  } else {
    score -= 1;
    allOptions[index].style.backgroundColor = "#e53935";
    allOptions[quizData[currentQuestion].correct].style.backgroundColor = "#43a047";
  }
}

/* ========== 7Ô∏è‚É£ ‡§Ö‡§ó‡§≤‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§¨‡§ü‡§® ========== */
nextBtn.addEventListener("click", () => {
  if (selectedOption === null) {
    alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§â‡§§‡•ç‡§§‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§");
    return;
  }

  currentQuestion++;
  selectedOption = null;

  if (currentQuestion < quizData.length) {
    loadQuestion();
  } else {
    showResults();
  }
});

/* ========== 8Ô∏è‚É£ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ========== */
function showResults() {
  quizContainer.classList.add("hidden");
  resultContainer.classList.remove("hidden");

  const totalQuestions = quizData.length;
  finalScore.textContent = `‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§ï‡•ã‡§∞: ${score} / ${totalQuestions * 4}`;

  explanationBox.innerHTML = "";
  quizData.forEach((q, i) => {
    const div = document.createElement("div");
    div.classList.add("explanation-item");
    div.innerHTML = `
      <h3>‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${i + 1}: ${q.question}</h3>
      <p><b>‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</b> ${q.options[q.correct]}</p>
      <p><b>‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ:</b> ${q.explanation}</p>
      <hr/>
    `;
    explanationBox.appendChild(div);
  });
}

/* ========== 9Ô∏è‚É£ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ========== */
restartBtn.addEventListener("click", () => {
  currentQuestion = 0;
  score = 0;
  selectedOption = null;
  resultContainer.classList.add("hidden");
  languageSelector.classList.remove("hidden");
});

/* ========== üîü ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§è‡§ï‡•Ä‡§ï‡§∞‡§£ ‡§π‡•á‡§§‡•Å Voice Hook ========== */
// Voice Engine Module (voiceEngine.js) ‡§á‡§∏ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§° ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§ó‡§æ
window.playVoiceForQuestion = function (text) {
  if ("speechSynthesis" in window) {
    const speech = new SpeechSynthesisUtterance(text);
    speech.lang = "hi-IN";
    speech.rate = 1.0;
    window.speechSynthesis.speak(speech);
  }
};

// ‡§π‡§∞ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡§∞ ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§µ‡§æ‡§ö‡§®
questionText.addEventListener("DOMSubtreeModified", () => {
  window.playVoiceForQuestion(questionText.textContent);
});
